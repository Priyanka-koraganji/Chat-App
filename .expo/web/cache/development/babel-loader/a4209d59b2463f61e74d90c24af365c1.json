{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from 'react';\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport { GiftedChat, Bubble } from 'react-native-gifted-chat';\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport KeyboardAvoidingView from \"react-native-web/dist/exports/KeyboardAvoidingView\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\n\nvar firebase = require('firebase');\n\nrequire('firebase/firestore');\n\nvar Chat = function (_React$Component) {\n  _inherits(Chat, _React$Component);\n\n  var _super = _createSuper(Chat);\n\n  function Chat(props) {\n    var _this;\n\n    _classCallCheck(this, Chat);\n\n    _this = _super.call(this, props);\n\n    _this.onCollectionUpdate = function (querySnapshot) {\n      var messages = [];\n      querySnapshot.forEach(function (doc) {\n        var _data$createdAt;\n\n        var data = doc.data();\n        messages.push({\n          _id: data._id,\n          text: data.text,\n          createdAt: (_data$createdAt = data.createdAt) == null ? void 0 : _data$createdAt.toDate(),\n          user: {\n            _id: data.user._id,\n            name: data.user.name,\n            avatar: data.user.avatar || ''\n          }\n        });\n      });\n\n      _this.setState({\n        messages: messages\n      });\n    };\n\n    _this.state = {\n      messages: [],\n      uid: 0,\n      user: {\n        _id: '',\n        name: '',\n        avatar: ''\n      }\n    };\n    var firebaseConfig = {\n      apiKey: \"AIzaSyBQF4hVb36u56Q--Usb76HliDu3zD3YIxU\",\n      authDomain: \"chatapp-b91f5.firebaseapp.com\",\n      projectId: \"chatapp-b91f5\",\n      storageBucket: \"chatapp-b91f5.appspot.com\",\n      messagingSenderId: \"132737882655\",\n      appId: \"1:132737882655:web:9a26378385be748f84132a\",\n      measurementId: \"G-D61GNPCPCK\"\n    };\n\n    if (!firebase.apps.length) {\n      firebase.initializeApp(firebaseConfig);\n    }\n\n    _this.referenceChatMessages = firebase.firestore().collection('messages');\n    return _this;\n  }\n\n  _createClass(Chat, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var name = this.props.route.params.name;\n      this.props.navigation.setOptions({\n        title: name\n      });\n      this.referenceChatMessages = firebase.firestore().collection('messages');\n      this.authUnsubscribe = firebase.auth().onAuthStateChanged(function _callee(user) {\n        return _regeneratorRuntime.async(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (!user) {\n                  firebase.auth().signInAnonymously();\n                }\n\n                _this2.setState({\n                  uid: user.uid,\n                  messages: [],\n                  user: {\n                    _id: user.uid,\n                    name: name\n                  }\n                });\n\n                _this2.unsubscribe = _this2.referenceChatMessages.orderBy(\"createdAt\", \"desc\").onSnapshot(_this2.onCollectionUpdate);\n\n              case 3:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, null, null, null, Promise);\n      });\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.unsubscribe();\n      this.authUnsubscribe();\n    }\n  }, {\n    key: \"onSend\",\n    value: function onSend() {\n      var messages = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n      this.setState(function (previousState) {\n        return {\n          messages: GiftedChat.append(previousState.messages, messages)\n        };\n      });\n      var newMessage = this.state.messages[0];\n      this.referenceChatMessages.add({\n        uid: this.state.uid,\n        _id: newMessage._id,\n        text: newMessage.text,\n        createdAt: newMessage.createdAt,\n        user: newMessage.user\n      });\n    }\n  }, {\n    key: \"renderBubble\",\n    value: function renderBubble(props) {\n      return _jsx(Bubble, _objectSpread(_objectSpread({}, props), {}, {\n        wrapperStyle: {\n          left: {\n            backgroundColor: '#fafafa'\n          },\n          right: {\n            backgroundColor: '#2d7ecf'\n          }\n        }\n      }));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var name = this.props.route.params.name;\n      var color = this.props.route.params.color;\n\n      if (color === '') {\n        color = '#8A95A5';\n      }\n\n      return _jsxs(View, {\n        style: [{\n          backgroundColor: color\n        }, {\n          flex: 1\n        }],\n        children: [_jsx(GiftedChat, {\n          renderBubble: this.renderBubble.bind(this),\n          messages: this.state.messages,\n          onSend: function onSend(messages) {\n            return _this3.onSend(messages);\n          },\n          user: {\n            _id: this.state.user._id,\n            name: this.state.user.name\n          }\n        }), Platform.OS === 'android' ? _jsx(KeyboardAvoidingView, {\n          behavior: \"height\"\n        }) : null]\n      });\n    }\n  }]);\n\n  return Chat;\n}(React.Component);\n\nexport { Chat as default };","map":{"version":3,"names":["React","GiftedChat","Bubble","firebase","require","Chat","props","onCollectionUpdate","querySnapshot","messages","forEach","doc","data","push","_id","text","createdAt","toDate","user","name","avatar","setState","state","uid","firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","apps","length","initializeApp","referenceChatMessages","firestore","collection","route","params","navigation","setOptions","title","authUnsubscribe","auth","onAuthStateChanged","signInAnonymously","unsubscribe","orderBy","onSnapshot","previousState","append","newMessage","add","left","backgroundColor","right","color","flex","renderBubble","bind","onSend","Platform","OS","Component"],"sources":["/Users/prashantpriya/Desktop/CF Projects/chatApp/components/Chat.js"],"sourcesContent":["import React from 'react';\nimport { StyleSheet, View, Text, TextInput, Button, FlatList } from 'react-native';\nimport { GiftedChat, Bubble } from 'react-native-gifted-chat';\nimport { Platform, KeyboardAvoidingView } from 'react-native';\n\n//import firebase\nconst firebase = require('firebase');\nrequire('firebase/firestore');\n\nexport default class Chat extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            messages: [],\n            uid: 0,\n            user: {\n                _id: '',\n                name: '',\n                avatar: '',\n            }\n        }\n        //config keys\n        const firebaseConfig = {\n            apiKey: \"AIzaSyBQF4hVb36u56Q--Usb76HliDu3zD3YIxU\",\n            authDomain: \"chatapp-b91f5.firebaseapp.com\",\n            projectId: \"chatapp-b91f5\",\n            storageBucket: \"chatapp-b91f5.appspot.com\",\n            messagingSenderId: \"132737882655\",\n            appId: \"1:132737882655:web:9a26378385be748f84132a\",\n            measurementId: \"G-D61GNPCPCK\"\n        }\n\n        if (!firebase.apps.length) {\n            firebase.initializeApp(firebaseConfig);\n        }\n        this.referenceChatMessages = firebase.firestore().collection('messages');\n    }\n\n    onCollectionUpdate = (querySnapshot) => {\n        const messages = [];\n        // go through each document\n        querySnapshot.forEach((doc) => {\n            // get the QueryDocumentSnapshot's data\n            let data = doc.data();\n            messages.push({\n                _id: data._id,\n                text: data.text,\n                createdAt: data.createdAt?.toDate(),\n                user: {\n                    _id: data.user._id,\n                    name: data.user.name,\n                    avatar: data.user.avatar || '',\n                },\n            });\n        });\n        this.setState({\n            messages,\n        });\n    }\n    componentDidMount() {\n        let { name } = this.props.route.params;\n        this.props.navigation.setOptions({ title: name });\n\n        this.referenceChatMessages = firebase.firestore().collection('messages');\n        // this.unsubscribeListUser = this.referenceChatMessages.onSnapshot(this.onCollectionUpdate);\n\n\n        this.authUnsubscribe = firebase.auth().onAuthStateChanged(async (user) => {\n            if (!user) {\n                firebase.auth().signInAnonymously();\n            }\n            this.setState({\n                uid: user.uid,\n                messages: [],\n                user: {\n                    _id: user.uid,\n                    name: name,\n                },\n            });\n            // this.referenceChatMessageslistUser = firebase.firestore().collection('messages').where(\"uid\", \"==\", this.state.uid);\n            this.unsubscribe = this.referenceChatMessages\n                .orderBy(\"createdAt\", \"desc\")\n                .onSnapshot(this.onCollectionUpdate);\n        });\n    }\n\n    componentWillUnmount() {\n        this.unsubscribe();\n        this.authUnsubscribe();\n    }\n\n\n    onSend(messages = []) {\n        this.setState(previousState => ({\n            messages: GiftedChat.append(previousState.messages, messages),\n        }))\n        const newMessage = this.state.messages[0]\n        this.referenceChatMessages.add({\n            uid: this.state.uid,\n            _id: newMessage._id,\n            text: newMessage.text,\n            createdAt: newMessage.createdAt,\n            user: newMessage.user\n        })\n    }\n    renderBubble(props) {\n        return (\n            <Bubble\n                {...props}\n                wrapperStyle={{\n                    left: {\n                        backgroundColor: '#fafafa',\n                    },\n                    right: {\n                        backgroundColor: '#2d7ecf',\n                    },\n                }}\n            />\n        )\n    }\n\n    render() {\n        let name = this.props.route.params.name;\n        let color = this.props.route.params.color;\n        if (color === '') {\n            color = '#8A95A5';\n        }\n        return (\n            <View style={[{ backgroundColor: color }, { flex: 1 }]}>\n                <GiftedChat\n                    renderBubble={this.renderBubble.bind(this)}\n                    messages={this.state.messages}\n                    onSend={(messages) => this.onSend(messages)}\n                    user={{ _id: this.state.user._id, name: this.state.user.name }}\n                />\n\n                {\n                    Platform.OS === 'android' ? <KeyboardAvoidingView behavior=\"height\" /> : null\n                }\n            </View>\n        )\n\n    }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}